# 第十章：防止钱包私钥丢失

## 一.关于钱包的私钥

现在市场上的大部分数字货币钱包，如果你把助记词和钱包私钥搞丢了，整个钱包基本上算是丢失了。笔者就遇到过这样的问题，笔者使用biwork钱包，钱包里面有10000LET、3个EOS和0.45个以太坊,biwork钱包是一个去中心化的钱包，它的私钥和助记词编码串是存储在客户端。后来我不小心把手机的内屏和外屏的砸碎，修手机的费用已经超过我钱包中币的价值。当时我备份的助记词找不到了，到现在为止我这个币也没有拿出来。

做区块链钱包开发的开发者应该都知道，目前最流行的是HD钱包（确定性分层钱包），它支持多钱包，多币种，多账户。对于每个钱包，最核心的部分是助记词，助记词在客户端存储方式一个编码串；通过这个编码串可以恢复助记词，通过助记词又恢复整个账户。对于每个钱包，它还有一个主私钥可以恢复这个钱包；而对于每个账户，都拥有自己的私钥，通过私钥是完全能找回这个账户的。也可以转走这个钱包中的数字资产。

不管是助记词编码串，钱包私钥，还是每个账户的私钥，它都是一个十六进制的一个字符串。对于这个字符串呢，我们有很多种处理方式。

## 二.抗丢失的钱包助记词、钱包私钥、钱包账户私钥存储方案

去中心化的钱包，不管是助记词，钱包私钥，还是钱包账户的私钥，都是存储在客户端。一旦我们的备份存储助记词，钱包私钥，钱包账户的私钥的文件丢失，我们客户端的钱包损坏，对于加密数字资产持有者是致命的，这将意味着数字资产持有者将会损失所有的加密货币。

我们做一个产品的原则是让用户使用起来更简单，现在我们市场的数字资产钱包总是喜欢让用户自己去备份助记词或者私钥，实际上这种做法是比较愚蠢的。为什么这样说呢，对于一个非技术人员来说，助记词，私钥这些东西，在用户的心里面是没有什么概念的。你在钱包内部发出的提示语很多用户可能都懒得看一眼。总的一句话来说，目前市场的数字资产钱包使用是有门槛的。

### 1.从硬件角度解决这个问题

助记词（助记词可编码存储）或密钥在本地客户端生成之后，使用蓝牙的通信方式将密钥下发到小型硬件设备。

.： 
    ![.： 
](https://github.com/guoshijiang/blockchain-wallet/blob/master/img/privateKey.png)

这种方式的优点是保证了私钥和助记词编码串存储的私密行，当客户端彻底崩溃的时候，助记词或私钥还可以通过小型的硬件设备来找回。助记词或私钥不再强烈依靠客户端，也不再依靠用户的备份。在这里面，硬件只是做了一个助记词或私钥的备份功能，钱包只有在助记词或密钥找回的时候才会依赖于小型硬件设备。其他的任何时候钱包是可以独立使用的。

当然，事情总是有对立面，解决问题的同时它也带来来一些问题。使用这种小型硬件会使钱包的造价和使用成本偏高。

5G 时代的到来将会使得物联网的高速发展，物联网的发展也将给区块链钱包私钥的存储带来很好的解决方案，将来你的私钥可以存储在很多自己家里的设备中，当你私钥丢失时，只要将家里的设备接入网络，你就可以找回私钥。当然，物联网中的“物”是处在网络环境中的，这也是有安全性问题的。

#### 1.1.小型硬件解决密钥丢失方案详细设计

下面的图是小型硬件设备存储密钥的一个简单的逻辑设计图，数据传输的方式采用蓝牙传输，包括密钥的备份和恢复两个过程。

.： 
    ![.： 
](https://github.com/guoshijiang/blockchain-wallet/blob/master/img/1231.png)



##### 密钥的备份过程

钱包通过助记词算法产生助记词，将助记词编码，并将编码串使用密码加密，然后通过蓝牙通信的方式将加密的助记词编码串传输到小型硬件设备；或者钱包生成私钥之后，用密码将私钥加密，然后通过蓝牙通信方式传输到小型硬件设备。这个过程称为密钥的备份过程。


##### 密钥的恢复过程

当用的承载钱包的设备坏，并且忘记助记词的情况下，就需要启动密钥的恢复过程。正常小型硬件设备里面会存储一些验证用户的数据，当小型硬件设备验证用户通过之后，就可以发起蓝牙连接。蓝牙连接完成后，硬件设备将加密的私钥或者加密的助记词编码串发送到钱包，钱包接到加密串之后，让用户输入密码解密编码串或者私钥。解密之后用户就可以使用助记词和私钥恢复自己的钱包了。


### 2.密钥共享托管

#### 2.1.门限密钥共享









